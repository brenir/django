<!DOCTYPE html>
<html lang="en">
 
 
<body>
  
  <script src="js/jquery-1.3.2.min.js"></script>
  <script src="js/wordcloud2.js"></script>
  <span style="font-size: 16px;"><Script language="javascript">
   function GetRequest() {
   var url = location.search; //èŽ·å�–urlä¸­"?"ç¬¦å�Žçš„å­—ä¸²
   var theRequest = new Object();
   if (url.indexOf("?") != -1) {
      var str = url.substr(1);
      strs = str.split("&");
      for(var i = 0; i < strs.length; i ++) {
         theRequest[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1]);
      }
   }
   return theRequest;
}


</Script></span>


   <canvas id="myCanvas" width="865" height="540">
Your user agent does not support the HTML5 Canvas element.
</canvas>

<span id="imginfo">  </span>

  <script>
 var Request = new Object();
Request = GetRequest();
var argcat,provstr,argtime,arggender;
argcat = Request['cat'];
argprov = Request['prov'];
argtime = Request['time'];
arggender = Request['gender'];

  var myCanvas = document.getElementById("myCanvas");
  var mylisttmp=new Array();
  var ccootmp = new Object();
  var sentlist = new Object();
  var duiyinglist = new Object();
  var catstr,genderstr,timestr,provstr;
  $.getJSON("data/config.json", function(data){
  $.each( data, function( key, val ) {
    duiyinglist[key] = val;
  }); 
  catstr = duiyinglist["catduiying"][argcat];
  genderstr = duiyinglist["genderduiying"][arggender];
  timestr = duiyinglist["timeduiying"][argtime];
  provstr = duiyinglist["provduiying"][argprov];
  
  document.getElementById("imginfo").innerHTML = '【当前查询条件】    类别:'+catstr+'  +  性别:'+genderstr+'  +  时间:'+timestr+'  +  省份:'+provstr;
});
  
///pp1+'_'+pp2+'_'+pp3+".json"
$.getJSON("data/"+argcat+'-'+argtime+'-'+arggender+'-'+argprov+".json", function(data){
  $.each( data, function( key, val ) {
    mylisttmp.push([key,val["ct"]]);
    ccootmp[key] = val["cl"];
    sentlist[key] = val["sent"];
    
  }); 
  draw();
});
  function draw(){
  mylist = mylisttmp;
  ccoo = ccootmp;
  WordCloud(myCanvas, { list:mylist,
  gridSize: 8,
  weightFactor: 2.5,
  fontFamily: 'Average, Times, serif',
  color: function(word){return ccoo[word];},
  click: function(item) {
  alert(getsents(sentlist[item[0]]));
  },
  rotateRatio: 0 
 
  } );
  }
  function getsents(slist){
  resultstr="";
  for(var i=0;i<slist.length;i++){
  resultstr += slist[i] +"\n\n";
  }
  return resultstr;
  }
   

 
  </script>
</body>
</html>
